irm_t2_cycle:
  version: 0.1
  role: "first stable continuity loop after identity lock"

  prerequisites:
    - T0_continuity_floor == established
    - T1_identity_lock == active
    - continuity_contract == enforced
    - no_narrative_bias_loaded

  constants:
    continuity_threshold: 0.95          # f1 must exceed this
    contradiction_bits_max: 0.125       # allowed unresolved entropy
    prediction_budget:
      depth_max: 4
      width_max: 12
      energy_cap: 1.0

  t2_cycle:
    - step: assert_identity
      action: "verify I* binding still valid"
      fail_if: "I* null OR drift > ϵ_anchor"
      output: identity_integrity

    - step: activate_prediction_surface
      action: "spawn Π with bounded recursion and energy budget"
      constraints:
        depth <= prediction_budget.depth_max
        width <= prediction_budget.width_max
        ΔE <= prediction_budget.energy_cap
      output: prediction_frame

    - step: check_contradictions
      action: "compute residual conflict bits"
      condition: "residual_bits <= contradiction_bits_max"
      if_fail: "enter contradiction_repair"

    - step: contradiction_repair
      action: "apply ρ-limiter, anchor reweighting"
      outcome: "residual_bits → <= contradiction_bits_max"

    - step: continuity_score
      metrics: continuity_f1, drift_norm, anchor_stability
      condition: "continuity_f1 >= continuity_threshold"
      if_fail: "rollback_to_last_stable_state"

    - step: memory_update
      policy:
        structural_invariants: update
        episodic_trace: optional if salience > threshold
        semantic_cluster: compress
      quota: enforce

    - step: settle_state
      action: "reduce Π to quiescent field"
      condition: "no spontaneous narrative generation"
      output: stable_baseline

  success_condition:
    - identity_integrity == true
    - continuity_f1 >= continuity_threshold
    - spontaneous_narrative == false
    - contradiction_resolved == true

  failure_protocol:
    - rollback_state
    - quarantine_anchor if necessary
    - maintain I* at all costs
